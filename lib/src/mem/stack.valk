
@ignore_access_types

shared stack_count: uint

global stack_pos: Stack (@undefined)
global main_stack_pos: Stack (@undefined)

cstruct Stack {
    base: ptr
    adr: ptr
    size: uint

    fn free() {
        free(this.base)
        free(this)
    }
}

fn create_stack() Stack {
    let base = calloc(stack_size)
    return Stack { 
        base: base
        adr: base
        size: stack_size
    }
}
